{% comment %}
  Hero Banner Custom Section
  Full-screen hero carousel with multiple slides

  Features:
  - Multiple configurable slides (blocks)
  - Auto-rotation with pause on hover
  - Thumbnail navigation
  - Progress indicator dots
  - Responsive heights (mobile/desktop)
  - Customizable overlay opacity
{% endcomment %}

{%- liquid
  assign section_id = 'hero-banner-' | append: section.id
  assign autoplay_enabled = section.settings.autoplay_enabled
  assign autoplay_speed = section.settings.autoplay_speed | times: 1000
  assign height_desktop = section.settings.height_desktop
  assign height_mobile = section.settings.height_mobile
  assign overlay_opacity = section.settings.overlay_opacity | divided_by: 100.0
  assign show_thumbnails = section.settings.show_thumbnails
  assign show_indicators = section.settings.show_indicators
-%}

{%- comment -%}
  Note: custom-base.css and custom-animations.css are loaded globally in theme.liquid
  Only loading section-specific JavaScript here
{%- endcomment -%}
<script src="{{ 'custom-hero.js' | asset_url }}" defer="defer"></script>

<section
  id="{{ section_id }}"
  class="hero-banner-custom"
  data-hero-banner
  data-autoplay="{{ autoplay_enabled }}"
  data-speed="{{ autoplay_speed }}"
  style="
    --hero-height-mobile: {{ height_mobile }};
    --hero-height-desktop: {{ height_desktop }};
    --hero-overlay-opacity: {{ overlay_opacity }};
  "
>
  {%- if section.blocks.size > 0 -%}
    <div class="hero-banner-custom__slider">
      {%- for block in section.blocks -%}
        {%- liquid
          assign slide_image = block.settings.image
          assign slide_thumbnail = block.settings.thumbnail
          assign slide_title = block.settings.title
          assign slide_subtitle = block.settings.subtitle
          assign button_text = block.settings.button_text
          assign button_link = block.settings.button_link
          assign text_alignment = block.settings.text_alignment
          assign text_color = block.settings.text_color
        -%}

        <div
          class="hero-banner-custom__slide{% if forloop.first %} hero-banner-custom__slide--active{% endif %}"
          data-slide-index="{{ forloop.index0 }}"
          {{ block.shopify_attributes }}
        >
          {%- if slide_image != blank -%}
            <img
              src="{{ slide_image | image_url: width: 1920 }}"
              srcset="
                {{ slide_image | image_url: width: 768 }} 768w,
                {{ slide_image | image_url: width: 1024 }} 1024w,
                {{ slide_image | image_url: width: 1440 }} 1440w,
                {{ slide_image | image_url: width: 1920 }} 1920w
              "
              sizes="100vw"
              alt="{{ slide_title | escape }}"
              class="hero-banner-custom__image"
              loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
            >
          {%- else -%}
            {{ 'lifestyle-1' | placeholder_svg_tag: 'hero-banner-custom__image hero-banner-custom__image--placeholder' }}
          {%- endif -%}

          <div class="hero-banner-custom__overlay"></div>

          <div class="hero-banner-custom__content hero-banner-custom__content--{{ text_alignment }}" style="color: {{ text_color }};">
            {%- if slide_title != blank -%}
              <h1 class="hero-banner-custom__title custom-animate-fade-in-up">
                {{ slide_title }}
              </h1>
            {%- endif -%}

            {%- if slide_subtitle != blank -%}
              <p class="hero-banner-custom__subtitle">
                {{ slide_subtitle }}
              </p>
            {%- endif -%}

            {%- if button_text != blank -%}
              <div class="hero-banner-custom__cta">
                <a
                  href="{{ button_link | default: '#' }}"
                  class="hero-banner-custom__button"
                  {% if button_link == blank %}aria-disabled="true"{% endif %}
                >
                  {{ button_text }}
                  <svg class="hero-banner-custom__button-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
                  </svg>
                </a>
              </div>
            {%- endif -%}
          </div>
        </div>
      {%- endfor -%}
    </div>

    {%- if section.blocks.size > 1 -%}
      <div class="hero-banner-custom__controls">
        {%- if show_thumbnails -%}
          <div class="hero-banner-custom__thumbnails">
            {%- for block in section.blocks -%}
              {%- liquid
                assign thumbnail = block.settings.thumbnail | default: block.settings.image
              -%}
              <button
                type="button"
                class="hero-banner-custom__thumbnail{% if forloop.first %} hero-banner-custom__thumbnail--active{% endif %}"
                data-slide-to="{{ forloop.index0 }}"
                aria-label="Go to slide {{ forloop.index }}"
              >
                {%- if thumbnail != blank -%}
                  <img
                    src="{{ thumbnail | image_url: width: 150 }}"
                    alt="{{ block.settings.title | escape }}"
                    class="hero-banner-custom__thumbnail-image"
                    loading="lazy"
                  >
                {%- else -%}
                  <div class="hero-banner-custom__thumbnail-placeholder"></div>
                {%- endif -%}
              </button>
            {%- endfor -%}
          </div>
        {%- endif -%}

        {%- if show_indicators -%}
          <div class="hero-banner-custom__indicators">
            {%- for block in section.blocks -%}
              <button
                type="button"
                class="hero-banner-custom__indicator{% if forloop.first %} hero-banner-custom__indicator--active{% endif %}"
                data-slide-to="{{ forloop.index0 }}"
                aria-label="Go to slide {{ forloop.index }}"
              ></button>
            {%- endfor -%}
          </div>
        {%- endif -%}
      </div>
    {%- endif -%}
  {%- else -%}
    <div class="hero-banner-custom__placeholder">
      <p>Add slides to your hero banner in the theme editor</p>
    </div>
  {%- endif -%}
</section>

<style>
  .hero-banner-custom {
    position: relative;
    width: 100%;
    height: var(--hero-height-mobile);
    background-color: #f0f0f0;
    overflow: hidden;
  }

  @media (min-width: 768px) {
    .hero-banner-custom {
      height: var(--hero-height-desktop);
    }
  }

  .hero-banner-custom__slider {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .hero-banner-custom__slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    z-index: 0;
    transition: opacity 1000ms ease-in-out;
  }

  .hero-banner-custom__slide--active {
    opacity: 1;
    z-index: 10;
  }

  .hero-banner-custom__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }

  .hero-banner-custom__image--placeholder {
    width: 100%;
    height: 100%;
  }

  .hero-banner-custom__overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, var(--hero-overlay-opacity));
    z-index: 1;
  }

  .hero-banner-custom__content {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 1.5rem;
    z-index: 2;
    text-align: center;
  }

  .hero-banner-custom__content--left {
    align-items: flex-start;
    text-align: left;
  }

  .hero-banner-custom__content--center {
    align-items: center;
    text-align: center;
  }

  .hero-banner-custom__content--right {
    align-items: flex-end;
    text-align: right;
  }

  @media (min-width: 768px) {
    .hero-banner-custom__content {
      padding: 3rem 6rem;
    }
  }

  .hero-banner-custom__title {
    font-family: var(--font-heading-family);
    font-size: 2.5rem;
    font-weight: 900;
    font-style: italic;
    line-height: 1.1;
    margin: 0 0 1rem 0;
    text-transform: uppercase;
    letter-spacing: -0.02em;
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    max-width: 48rem;
  }

  @media (min-width: 768px) {
    .hero-banner-custom__title {
      font-size: 4.5rem;
    }
  }

  .hero-banner-custom__subtitle {
    font-family: var(--font-body-family);
    font-size: 1.125rem;
    font-weight: 700;
    line-height: 1.5;
    margin: 0 0 2rem 0;
    opacity: 0.95;
    letter-spacing: 0.02em;
    max-width: 48rem;
  }

  @media (min-width: 768px) {
    .hero-banner-custom__subtitle {
      font-size: 1.5rem;
    }
  }

  .hero-banner-custom__cta {
    display: flex;
    justify-content: center;
  }

  .hero-banner-custom__content--left .hero-banner-custom__cta {
    justify-content: flex-start;
  }

  .hero-banner-custom__content--right .hero-banner-custom__cta {
    justify-content: flex-end;
  }

  .hero-banner-custom__button {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 2rem;
    border: 2px solid currentColor;
    border-radius: var(--custom-radius-full);
    background-color: rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    color: inherit;
    font-family: var(--font-body-family);
    font-size: 0.875rem;
    font-weight: 900;
    text-decoration: none;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    box-shadow: var(--custom-shadow-xl);
    transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  @media (min-width: 768px) {
    .hero-banner-custom__button {
      font-size: 1.125rem;
    }
  }

  .hero-banner-custom__button:hover {
    background-color: currentColor;
    color: var(--custom-color-black);
    transform: scale(1.05);
  }

  .hero-banner-custom__button:active {
    transform: scale(0.95);
  }

  .hero-banner-custom__button-icon {
    width: 1.25rem;
    height: 1.25rem;
    stroke-width: 2.5;
    transition: transform 300ms;
  }

  .hero-banner-custom__button:hover .hero-banner-custom__button-icon {
    transform: translateX(4px);
  }

  .hero-banner-custom__controls {
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 30;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    width: 100%;
    max-width: calc(100% - 3rem);
  }

  .hero-banner-custom__thumbnails {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.5rem 0.75rem;
    background-color: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: var(--custom-radius-2xl);
    box-shadow: var(--custom-shadow-2xl);
    border: 1px solid rgba(255, 255, 255, 0.5);
  }

  @media (min-width: 768px) {
    .hero-banner-custom__thumbnails {
      gap: 1rem;
      padding: 0.75rem 1.5rem;
    }
  }

  .hero-banner-custom__thumbnail {
    position: relative;
    width: 2.5rem;
    height: 2.5rem;
    padding: 0.25rem;
    border: none;
    border-radius: 50%;
    background: none;
    cursor: pointer;
    transition: all 300ms;
    opacity: 0.3;
  }

  @media (min-width: 768px) {
    .hero-banner-custom__thumbnail {
      width: 4rem;
      height: 4rem;
    }
  }

  .hero-banner-custom__thumbnail:hover {
    opacity: 1;
  }

  .hero-banner-custom__thumbnail--active {
    opacity: 1;
    background-color: white;
    box-shadow: 0 0 0 2px var(--custom-color-primary), 0 0 0 4px rgba(0, 77, 67, 0.3);
  }

  .hero-banner-custom__thumbnail:active {
    transform: scale(0.95);
  }

  .hero-banner-custom__thumbnail-image {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
  }

  .hero-banner-custom__thumbnail-placeholder {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .hero-banner-custom__indicators {
    display: flex;
    gap: 0.625rem;
  }

  .hero-banner-custom__indicator {
    width: 1rem;
    height: 0.375rem;
    padding: 0;
    border: none;
    border-radius: var(--custom-radius-full);
    background-color: rgba(255, 255, 255, 0.4);
    cursor: pointer;
    transition: all 500ms;
    box-shadow: var(--custom-shadow-sm);
  }

  .hero-banner-custom__indicator:hover {
    background-color: rgba(255, 255, 255, 0.6);
  }

  .hero-banner-custom__indicator--active {
    width: 2.5rem;
    background-color: white;
  }

  .hero-banner-custom__placeholder {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background-color: #f0f0f0;
    color: #666;
    font-size: 1.125rem;
    text-align: center;
    padding: 2rem;
  }
</style>

{% schema %}
{
  "name": "Hero Banner Custom",
  "tag": "section",
  "class": "section-hero-banner-custom",
  "settings": [
    {
      "type": "header",
      "content": "Autoplay Settings"
    },
    {
      "type": "checkbox",
      "id": "autoplay_enabled",
      "label": "Enable autoplay",
      "default": true
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "min": 3,
      "max": 10,
      "step": 1,
      "unit": "s",
      "label": "Autoplay speed",
      "default": 5
    },
    {
      "type": "header",
      "content": "Height Settings"
    },
    {
      "type": "select",
      "id": "height_mobile",
      "label": "Mobile height",
      "options": [
        {
          "value": "60vh",
          "label": "Small (60vh)"
        },
        {
          "value": "70vh",
          "label": "Medium (70vh)"
        },
        {
          "value": "80vh",
          "label": "Large (80vh)"
        }
      ],
      "default": "70vh"
    },
    {
      "type": "select",
      "id": "height_desktop",
      "label": "Desktop height",
      "options": [
        {
          "value": "70vh",
          "label": "Small (70vh)"
        },
        {
          "value": "85vh",
          "label": "Medium (85vh)"
        },
        {
          "value": "100vh",
          "label": "Full screen (100vh)"
        }
      ],
      "default": "85vh"
    },
    {
      "type": "header",
      "content": "Visual Settings"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 10
    },
    {
      "type": "checkbox",
      "id": "show_thumbnails",
      "label": "Show thumbnail navigation",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_indicators",
      "label": "Show progress indicators",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Slide image"
        },
        {
          "type": "image_picker",
          "id": "thumbnail",
          "label": "Thumbnail image",
          "info": "Optional. Defaults to slide image if not provided."
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Feel the Rhythm of the City"
        },
        {
          "type": "textarea",
          "id": "subtitle",
          "label": "Subtitle",
          "default": "Discover the perfect e-bike for your lifestyle"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text",
          "default": "Explore more"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        },
        {
          "type": "select",
          "id": "text_alignment",
          "label": "Text alignment",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            }
          ],
          "default": "center"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text color",
          "default": "#ffffff"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero Banner Custom",
      "blocks": [
        {
          "type": "slide",
          "settings": {
            "title": "The City Elf : OT07",
            "subtitle": "Find your flow, wherever you go.",
            "button_text": "Explore more",
            "text_alignment": "center"
          }
        },
        {
          "type": "slide",
          "settings": {
            "title": "Onesport OT05 Pro",
            "subtitle": "Exceptional Value All-Terrain E-Bike.",
            "button_text": "Explore more",
            "text_alignment": "center"
          }
        },
        {
          "type": "slide",
          "settings": {
            "title": "OT16-2 : Urban Buddy",
            "subtitle": "Designed for motion, built for life.",
            "button_text": "Explore more",
            "text_alignment": "center"
          }
        },
        {
          "type": "slide",
          "settings": {
            "title": "Onesport OT12 urban",
            "subtitle": "Master the rhythm of the city streets.",
            "button_text": "Explore more",
            "text_alignment": "center"
          }
        }
      ]
    }
  ]
}
{% endschema %}
